<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ORDS JS SDK Playground</title>

        <link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="codemirror/lib/codemirror.css">
        <script src="codemirror/lib/codemirror.js"></script>
        <script src="codemirror/mode/javascript/javascript.js"></script>
        <link rel="stylesheet" href="codemirror/theme/dracula.css">
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="#">ORDS JS SDK</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item active">
                        <a class="nav-link" href="./">Demo <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./doc/">Documentation</a>
                    </li>
                </ul>
            </div>
            <div>
                <textarea id="code" cols="30" rows="10"></textarea>
                <button type="button" onclick=" run() ">Press</button>
                <pre id="result"></pre>
            </div>
        </nav>
        <div class="d-flex h-100">
            <div id="left"></div>
            <div id="right">
                <pre id="jsonData"></pre>
            </div>
        </div>

        <!--script src="../node_modules/jquery/dist/jquery.slim.min.js"></script>
        <script src="../node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
        <script src="../node_modules/split.js/dist/split.min.js"></script-->


        <script>
            const gUrls = {
                collection: '%SNOWPACK_PUBLIC_COLLECTION_RESOURCE_URL%',
                item: '%SNOWPACK_PUBLIC_ITEM_RESOURCE_URL%',
                other: '%SNOWPACK_PUBLIC_OTHER_RESOURCE_URL%',
                authenticated: '%SNOWPACK_PUBLIC_AUTHENTICATED_RESOURCE_URL%'
            };
        </script>
        <script type="module">
            import { ORDSResource } from './resource.js';
            import { asyncSleep } from './utilities.js';

            var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
                lineNumbers: true,
                mode: "javascript",
                theme: "dracula"
            });

            function printData(pResource){
                document.querySelector( '#jsonData' ).textContent = JSON.stringify( pResource.jsonData, null, 4 );
            }

            Object.assign( window, {
                ORDSResource,
                printData,
                asyncSleep,
                editor
            })

            const AsyncFunction = Object.getPrototypeOf(async function(){}).constructor;

            window.run = function() {
                const code = editor.getValue()
                const fn = new AsyncFunction(code)
                
                fn()
                
            }

            
            // const gResource = new ORDSResource( gUrls.collection, {
            //     limit: 20
            // } );

            // await gResource.makeRequest();

            // printData(gResource)

            // await asyncSleep( 2000 );
            // await gResource.requestNextPage();
            // printData();

        </script>
    </body>
</html>